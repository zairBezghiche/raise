{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://genaptitude.local/schemas/v1/common/types/primitive-types.schema.json",
  "title": "Primitive Types (GenAptitude)",
  "type": "object",
  "$defs": {
    "instanceSchemaUri": {
      "title": "Instance $schema URI",
      "description": "Chemin RELATIF au répertoire schemas/v1. Rempli automatiquement par le système.",
      "type": "string",
      "format": "uri-reference",
      "pattern": "^(?:\\.\\./)*(?:[A-Za-z0-9_\\-]+/)+[A-Za-z0-9_\\-]+\\.schema\\.json$",
      "x_compute": {
        "engine": "plan/v1",
        "scope": "root",
        "update": "if_missing",
        "plan": {
          "op": "const",
          "value": ""
        }
      }
    },
    "_id": {
      "title": "Identifiant (UUID)",
      "description": "Identifiant unique au format UUID v4. Généré automatiquement si absent.",
      "type": "string",
      "pattern": "^[A-Za-z0-9._:-]{1,128}$",
      "format": "uuid",
      "x_compute": {
        "update": "if_missing",
        "plan": { "op": "uuid_v4" }
      }
    },
    "xmiId": {
      "title": "Capella XMI ID",
      "description": "Identifiant unique provenant du fichier source Capella (.capella/.aird).",
      "type": "string",
      "minLength": 1
    },
    "createdAt": {
      "title": "Horodatage de création",
      "type": "string",
      "format": "date-time",
      "x_compute": {
        "update": "if_missing",
        "plan": { "op": "now_rfc3339" }
      }
    },
    "updatedAt": {
      "title": "Dernière mise à jour",
      "type": "string",
      "format": "date-time",
      "x_compute": {
        "update": "always",
        "plan": { "op": "now_rfc3339" }
      }
    },
    "nonEmptyString": {
      "title": "Non-empty string",
      "type": "string",
      "minLength": 1
    },
    "i18nString": {
      "title": "Internationalized String",
      "description": "Texte simple ou objet multilingue (fr/en)",
      "oneOf": [
        {
          "type": "string",
          "minLength": 1
        },
        {
          "type": "object",
          "properties": {
            "fr": { "type": "string", "minLength": 1 },
            "en": { "type": "string", "minLength": 1 }
          },
          "required": ["fr", "en"],
          "additionalProperties": false
        }
      ]
    },
    "i18nNonEmptyString": {
      "title": "Legacy Alias for i18nString",
      "$ref": "#/$defs/i18nString"
    },
    "slug": {
      "title": "Slug",
      "type": "string",
      "pattern": "^[a-z0-9]([a-z0-9-_]*[a-z0-9])?$",
      "minLength": 1
    },
    "uuid": {
      "title": "UUID",
      "type": "string",
      "format": "uuid"
    },
    "DomainName": {
      "title": "Domain name",
      "type": "string",
      "format": "hostname"
    },
    "uri": {
      "title": "URI",
      "type": "string",
      "format": "uri"
    },
    "uriReference": {
      "title": "URI reference",
      "type": "string",
      "format": "uri-reference"
    },
    "url": {
      "title": "URL",
      "type": "string",
      "format": "uri"
    },
    "dateTime": {
      "title": "RFC3339 date-time",
      "type": "string",
      "format": "date-time"
    },
    "version": {
      "type": "string",
      "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$",
      "default": "1.0.0"
    },
    "semver": {
      "type": "string",
      "pattern": "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-[0-9A-Za-z.-]+)?(?:\\+[0-9A-Za-z.-]+)?$"
    },
    "email": {
      "title": "Email",
      "type": "string",
      "format": "email"
    },
    "phoneE164": {
      "title": "Phone (E.164)",
      "type": "string",
      "pattern": "^\\+[1-9]\\d{1,14}$"
    },
    "languageTag": {
      "title": "BCP 47 language tag",
      "type": "string",
      "pattern": "^[A-Za-z]{2,3}(-[A-Za-z0-9]{2,8})*$"
    },
    "locale": {
      "title": "Locale (BCP 47)",
      "allOf": [{ "$ref": "#/$defs/languageTag" }]
    },
    "percent0to100": {
      "type": "number",
      "minimum": 0,
      "maximum": 100
    },
    "percent0to1": {
      "type": "number",
      "minimum": 0,
      "maximum": 1
    },
    "euroAmount": {
      "type": "number",
      "minimum": 0
    },
    "quantity": {
      "type": "number",
      "minimum": 0
    },
    "db_itemRef": {
      "oneOf": [
        { "type": "string", "pattern": "^(?:[A-Za-z0-9_\\-]+/)+[A-Za-z0-9_\\-]+\\.json$" },
        {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "file": {
              "type": "string",
              "pattern": "^(?:[A-Za-z0-9_\\-]+/)+[A-Za-z0-9_\\-]+\\.json$"
            }
          },
          "required": ["file"]
        }
      ]
    },
    "db_collection": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "schema": {
          "type": "string",
          "description": "Chemin RELATIF",
          "pattern": "^(?:[A-Za-z0-9_\\-]+/)+[A-Za-z0-9_\\-]+\\.schema\\.json$"
        },
        "items": {
          "type": "array",
          "items": { "$ref": "#/$defs/db_itemRef" },
          "default": []
        }
      },
      "required": ["schema", "items"]
    },
    "x_emoji": {
      "title": "Emoji",
      "type": "string",
      "minLength": 1
    },
    "ordinal": {
      "type": "integer",
      "minimum": 0
    }
  }
}
