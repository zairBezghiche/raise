{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://genaptitude.local/schemas/v1/uml/metamodel/metamodel.schema.json",
  "title": "UML Metamodel",
  "description": "Définitions des propriétés logiques et sémantiques fondamentales et spécifiques aux entités de modélisation UML.",

  "x_schemaVersion": "1.0.0",
  "x_label": {
    "fr": "Méta-modèle UML",
    "en": "UML Metamodel"
  },

  "type": "object",

  "$defs": {
    "Ref": {
      "title": "Reference to another entity",
      "description": "Structure standard pour référencer une autre entité du modèle par son ID et son schéma.",
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "format": "uri"
        },
        "$schema": {
          "type": "string",
          "format": "uri-reference"
        }
      },
      "required": ["id", "$schema"],
      "unevaluatedProperties": false
    },

    "BaseProperties": {
      "title": "Base Modelling Entity Properties",
      "description": "Propriétés sémantiques que toute entité de modélisation doit posséder (Nom, Description, Stéréotypes).",
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "x_label": { "fr": "Nom", "en": "Name" },
          "description": "Nom usuel de l'entité de modélisation."
        },
        "description": {
          "type": "string",
          "x_label": { "fr": "Description", "en": "Description" },
          "description": "Description détaillée de l'entité."
        },
        "summary": {
          "type": "string",
          "x_label": { "fr": "Résumé", "en": "Summary" },
          "description": "Courte description pour les affichages condensés."
        },
        "stereotype": {
          "type": "array",
          "x_label": { "fr": "Stéréotypes", "en": "Stereotypes" },
          "description": "Liste des stéréotypes appliqués à l'entité.",
          "items": {
            "$ref": "#/$defs/Ref"
          }
        },
        "labels": {
          "type": "array",
          "x_label": { "fr": "Étiquettes", "en": "Labels" },
          "description": "Étiquettes non formelles pour le filtrage et l'organisation.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": ["name"]
    },

    "Tag": {
      "title": "Tagged Value",
      "description": "Définition d'une valeur étiquetée pour l'extensibilité des éléments UML (utilisé par les profils SysML/MARTE).",
      "type": "object",
      "properties": {
        "tag": {
          "type": "string",
          "description": "Nom de la balise."
        },
        "value": {
          "type": "string",
          "description": "Valeur associée à la balise."
        }
      },
      "required": ["tag", "value"],
      "unevaluatedProperties": false
    },

    "ConnectionPoint": {
      "title": "Connection Point",
      "description": "Point de connexion géométrique ou logique (ex: pour les Ports ou les Nœuds de déploiement).",
      "type": "object",
      "properties": {
        "x": {
          "type": "number"
        },
        "y": {
          "type": "number"
        },
        "onElement": {
          "$ref": "#/$defs/Ref",
          "description": "Référence à l'élément structurel auquel ce point de connexion appartient."
        }
      },
      "required": ["x", "y", "onElement"],
      "unevaluatedProperties": false
    },

    "TraceabilityLink": {
      "title": "Traceability Link",
      "description": "Lien de traçabilité formalisé (entre exigences, cas d'usage, et éléments de conception).",
      "type": "object",
      "properties": {
        "source": {
          "$ref": "#/$defs/Ref"
        },
        "target": {
          "$ref": "#/$defs/Ref"
        },
        "kind": {
          "type": "string",
          "enum": ["satisfies", "refines", "derives", "verifies", "allocates"],
          "description": "Nature de la relation de traçabilité (inspiré de SysML)."
        }
      },
      "required": ["source", "target", "kind"],
      "unevaluatedProperties": false
    }
  }
}
